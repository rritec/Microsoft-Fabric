
# AI Tools in Microsoft Fabric

Microsoft Fabric provides powerful AI capabilities to streamline data preparation, enrichment, and model training. This chapter explains the **three main AI tools** available under the **AI Tools** menu and demonstrates how to use **Data Wrangler** with a practical example.

***

## **Overview of AI Tools**

### 1. **Data Wrangler**

**Purpose:**  
Data Wrangler is an interactive data preparation tool that helps you clean, transform, and enrich datasets before modeling. It generates reproducible code for notebooks and pipelines.

**Key Operations:**

*   **Suggestions** – AI-driven recommendations for improving data quality.
*   **AI Enrichments** – Add intelligence (e.g., sentiment analysis, entity extraction).
*   **Find and Replace** – Standardize or correct values.
*   **Format** – Normalize text, date, and numeric formats.
*   **Formulas** – Apply custom calculations.
*   **Numeric** – Handle numeric transformations (scaling, imputation).
*   **Schema** – Manage column types and structure.
*   **Sort and Filter** – Organize and refine data.
*   **Group by and Aggregate** – Summarize data for analysis.
*   **Custom Operation** – Create your own transformation logic.
*   **Describe Operation with Copilot** – Get natural-language explanations for transformations.

***

### 2. **Set up an AI Function**

**Purpose:**  
Embed AI capabilities directly into your Fabric workflows. You can use pre-built AI functions (text analytics, vision, language detection) or custom ML models.

**When to Use:**

*   Apply AI logic during data transformation.
*   Enrich datasets with sentiment, key phrases, or image classification.
*   Score models in real-time or batch pipelines.

***

### 3. **New AutoML Run**

**Purpose:**  
Automates machine learning by handling:

*   Model selection
*   Hyperparameter tuning
*   Performance evaluation

**Supported Tasks:**

*   Classification
*   Regression
*   Forecasting

**When to Use:**

*   Quickly build and evaluate models without manual tuning.
*   Compare metrics like ROC AUC, validation loss, and accuracy.
*   Register the best model to MLflow for deployment.

***

## **Data Wrangler Demo**

Below is an example of how Data Wrangler generates Python code for cleaning and transforming a dataset. This example uses the Titanic dataset.

### **Step 1: Load Sample Data**

```python
import pandas as pd

wrangler_sample_df = pd.read_csv("https://aka.ms/wrangler/titanic.csv")
display(wrangler_sample_df)
```

### **Step 2: Clean and Transform Data**

```python
# Code generated by Data Wrangler for pandas DataFrame
import pandas as pd

def clean_data(wrangler_sample_df):
    # Split text using regex '\.\ |\s*,\s*' in column: 'Name'
    loc_0 = wrangler_sample_df.columns.get_loc('Name')
    wrangler_sample_df_split = wrangler_sample_df['Name'] \
        .str.split(pat='\\.\\ |\\s*,\\s*', expand=True, n=2) \
        .add_prefix('Name_')

    wrangler_sample_df = pd.concat(
        [wrangler_sample_df.iloc[:, :loc_0],
         wrangler_sample_df_split,
         wrangler_sample_df.iloc[:, loc_0:]],
        axis=1
    )
    wrangler_sample_df = wrangler_sample_df.drop(columns=['Name'])

    # Replace missing values with the mean of each column in: 'Age'
    wrangler_sample_df = wrangler_sample_df.fillna({'Age': wrangler_sample_df['Age'].mean()})

    # Drop column: 'PassengerId'
    wrangler_sample_df = wrangler_sample_df.drop(columns=['PassengerId'])

    # Rename columns
    wrangler_sample_df = wrangler_sample_df.rename(columns={
        'Name_0': 'FirstName',
        'Name_1': 'Suffix',
        'Name_2': 'LastName'
    })

    return wrangler_sample_df

wrangler_sample_df_clean = clean_data(wrangler_sample_df.copy())
display(wrangler_sample_df_clean)
```

***

## **Next Chapters**

1.  **AutoML Run** – Train and compare models using the prepared dataset.
2.  **AI Functions** – Apply AI enrichments or score models in pipelines.

***

