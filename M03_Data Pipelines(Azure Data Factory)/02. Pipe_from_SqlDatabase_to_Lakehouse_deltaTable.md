# Pipe_from_SqlDatabase_to_Lakehouse_deltaTable
---
## Step 1: Create SQL Database and create sample data.
- Go to the Workspace where you want to create your database.
- Click â€œ+ New itemâ€, then choose â€œSQL Databaseâ€
- Name your database (e.g., EmployeeDB) and click Create.


### ðŸ§° SQL Script: Create Tables + Insert Sample Data

```sql
-- Create department table
CREATE TABLE dept (
    dept_id INT PRIMARY KEY,
    dept_name VARCHAR(50)
);

-- Create employee table
CREATE TABLE emp (
    emp_id INT PRIMARY KEY,
    emp_name VARCHAR(100),
    hire_date DATE,
    salary DECIMAL(10, 2),
    dept_id INT,
    FOREIGN KEY (dept_id) REFERENCES dept(dept_id)
);

-- Insert sample records into dept
INSERT INTO dept (dept_id, dept_name) VALUES
(10, 'Sales'),
(20, 'Engineering'),
(30, 'HR');

-- Insert sample records into emp
INSERT INTO emp (emp_id, emp_name, hire_date, salary, dept_id) VALUES
(101, 'Alice Johnson', '2022-05-15', 72000.00, 20),
(102, 'Bob Smith', '2021-11-03', 68000.00, 10),
(103, 'Clara Martinez', '2023-01-10', 62000.00, 30),
(104, 'David Kim', '2020-08-20', 75000.00, 20);
```
---

Excellent catch ðŸ‘ â€” youâ€™re absolutely right.
If weâ€™re teaching **from the JSON**, then **Variable Library â†’ Variables â†’ Connection usage** must be shown **explicitly**, not implied.

Below is a **clean, corrected, click-by-click navigation guide** that **STRICTLY follows your JSON**:

* âœ” Uses **Variable Library**
* âœ” Creates variables **first**
* âœ” Uses variables **inside connections**
* âœ” Mirrors your JSON **1:1**
* âœ” GitHub-ready Markdown

You can replace your earlier navigation section with this.

---

---

## 1. Open Workspace

1. Go to **[https://app.fabric.microsoft.com](https://app.fabric.microsoft.com)**
2. Click **Workspaces**
3. Open your target workspace

---

## 2. Create Variable Library

1. In the workspace, click **New**
2. Select **Variable library**
3. Enter name:

   ```
   rr-master-workspace-variables
   ```
4. Click **Create**

---

## 3. Create Variables in Variable Library

1. Open **rr-master-workspace-variables**
2. Click **+ New variable**
3. Create the following variables **exactly**

---

### 3.1 Workspace ID Variable

* **Variable name**: `Workspaceid`
* **Type**: String
* **Value**:
  ðŸ‘‰ Copy from **Workspace â†’ Settings â†’ Workspace ID**

---

### 3.2 SQL Database Artifact ID Variable

* **Variable name**: `sqldatabases`
* **Type**: String
* **Value**:
  ðŸ‘‰ Open **SQL Database â†’ Settings â†’ Artifact ID**

---

### 3.3 SQL Database Connection ID Variable

* **Variable name**: `SqlDB_conn_id`
* **Type**: String
* **Value**:
  ðŸ‘‰ Open **Connections â†’ Fabric SQL Database â†’ Copy Connection ID**

---

### 3.4 Lakehouse Artifact ID Variable

* **Variable name**: `lakhouseid`
* **Type**: String
* **Value**:
  ðŸ‘‰ Open **Lakehouse â†’ Settings â†’ Artifact ID**

---

### 3.5 Lakehouse Connection ID Variable

* **Variable name**: `lakehouse_Conn_ID`
* **Type**: String
* **Value**:
  ðŸ‘‰ Open **Connections â†’ Lakehouse â†’ Copy Connection ID**

---

### 3.6 Save Variable Library

1. Click **Save**
2. Close Variable Library

---

## 4. Create Data Pipeline

1. In the workspace, click **New**
2. Select **Data pipeline**
3. Name:

   ```
   B2602_Pipe_from_SqlDatabase_to_Lakehouse_deltaTable
   ```
4. Click **Create**

---

## 5. Link Variable Library to Pipeline

> This step enables `@pipeline().libraryVariables`

1. Inside pipeline canvas, click **Pipeline settings**
2. Click **Variable libraries**
3. Click **+ Add variable library**
4. Select:

   ```
   rr-master-workspace-variables
   ```
5. Click **Add**

ðŸ“Œ This activates:

```json
@pipeline().libraryVariables.rrmasterworkspacevariables_*
```

---

## 6. Add Copy Data Activity

1. Click **+**
2. Select **Copy data**
3. Click **Copy data1**

---

## 7. Configure Source Using Variables (IMPORTANT)

### 7.1 Open Source Tab

1. Click **Copy data1**
2. Click **Source**
3. Click **+ New connection**

---

### 7.2 Create Fabric SQL Database Connection Using Variables

1. Select **Fabric SQL Database**
2. Switch to **Advanced / Expression mode**
3. Fill values using variables:

| Field           | Value                                                                  |
| --------------- | ---------------------------------------------------------------------- |
| Workspace ID    | `@pipeline().libraryVariables.rrmasterworkspacevariables_Workspaceid`  |
| SQL Database ID | `@pipeline().libraryVariables.rrmasterworkspacevariables_sqldatabases` |

4. Save connection

ðŸ“Œ Matches JSON:

```json
"workspaceId": "@pipeline().libraryVariables.rrmasterworkspacevariables_Workspaceid",
"artifactId": "@pipeline().libraryVariables.rrmasterworkspacevariables_sqldatabases"
```

---

### 7.3 Bind SQL Connection ID

1. In **Connection reference**
2. Use expression:

```text
@pipeline().libraryVariables.rrmasterworkspacevariables_SqlDB_conn_id
```

ðŸ“Œ Matches:

```json
"externalReferences": {
  "connection": "@pipeline().libraryVariables.rrmasterworkspacevariables_SqlDB_conn_id"
}
```

---

### 7.4 Select Source Table

1. **Schema** â†’ `dbo`
2. **Table** â†’ `emp`

---

## 8. Configure Sink Using Variables

### 8.1 Open Sink Tab

1. Click **Sink**
2. Click **+ New connection**

---

### 8.2 Create Lakehouse Connection Using Variables

1. Select **Lakehouse**
2. Use **Expression mode**
3. Enter:

| Field        | Value                                                                 |
| ------------ | --------------------------------------------------------------------- |
| Workspace ID | `@pipeline().libraryVariables.rrmasterworkspacevariables_Workspaceid` |
| Lakehouse ID | `@pipeline().libraryVariables.rrmasterworkspacevariables_lakhouseid`  |
| Root folder  | `Tables`                                                              |

ðŸ“Œ Matches:

```json
"rootFolder": "Tables"
```

---

### 8.3 Bind Lakehouse Connection ID

1. Connection reference:

```text
@pipeline().libraryVariables.rrmasterworkspacevariables_lakehouse_Conn_ID
```

---

### 8.4 Configure Sink Table

1. **Table name**:

   ```
   b262008_emp_data_from_sqldb
   ```
2. **Write behavior** â†’ Append
3. Enable **Apply V-Order**

---

## 9. Mapping & Type Conversion

1. Click **Mapping**
2. Click **Import schemas**
3. Enable:

   * Type conversion
   * Allow truncation

---

## 10. Disable Staging

1. Click **Settings**
2. Ensure **Enable staging** = OFF

---

## 11. Publish Pipeline

1. Click **Publish**
2. Wait for success message

---

## 12. Run & Monitor

1. Click **Run**
2. Open **Monitor**
3. Validate Copy activity success

---

## 13. JSON â†” UI Mapping Summary

| JSON Section                   | UI Location            |
| ------------------------------ | ---------------------- |
| `libraryVariables`             | Variable Library       |
| `@pipeline().libraryVariables` | Connection expressions |
| `FabricSqlDatabaseSource`      | Source â†’ SQL DB        |
| `LakehouseTableSink`           | Sink â†’ Lakehouse       |
| `applyVOrder`                  | Sink settings          |
| `Append`                       | Write behavior         |

---



---




## Home Work
- Pipe_from_Lakehouse_deltaTable_to_SqlDatabase
- Pipe_from_SqlDatabase_to_SqlDatabase

---
# pipeline code
```json
{
    "name": "B2602_Pipe_from_SqlDatabase_to_Lakehouse_deltaTable",
    "objectId": "59701fb9-67d8-4e29-8b78-f3d7aa61cf99",
    "properties": {
        "activities": [
            {
                "name": "Copy data1",
                "type": "Copy",
                "dependsOn": [],
                "policy": {
                    "timeout": "0.12:00:00",
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "typeProperties": {
                    "source": {
                        "type": "FabricSqlDatabaseSource",
                        "queryTimeout": "02:00:00",
                        "partitionOption": "None",
                        "datasetSettings": {
                            "annotations": [],
                            "connectionSettings": {
                                "name": "8be3fc2f_4c7d_41d3_8ab3_b9595e8bb000",
                                "properties": {
                                    "annotations": [],
                                    "type": "FabricSqlDatabase",
                                    "typeProperties": {
                                        "workspaceId": "@pipeline().libraryVariables.rrmasterworkspacevariables_Workspaceid",
                                        "artifactId": "@pipeline().libraryVariables.rrmasterworkspacevariables_sqldatabases"
                                    },
                                    "externalReferences": {
                                        "connection": "@pipeline().libraryVariables.rrmasterworkspacevariables_SqlDB_conn_id"
                                    }
                                }
                            },
                            "type": "FabricSqlDatabaseTable",
                            "schema": [],
                            "typeProperties": {
                                "schema": "dbo",
                                "table": "emp"
                            }
                        }
                    },
                    "sink": {
                        "type": "LakehouseTableSink",
                        "tableActionOption": "Append",
                        "partitionOption": "None",
                        "applyVOrder": true,
                        "datasetSettings": {
                            "annotations": [],
                            "connectionSettings": {
                                "name": "93657c4d_d27e_494c_8bef_f39a815ae4eb",
                                "properties": {
                                    "annotations": [],
                                    "type": "Lakehouse",
                                    "typeProperties": {
                                        "workspaceId": "@pipeline().libraryVariables.rrmasterworkspacevariables_Workspaceid",
                                        "artifactId": "@pipeline().libraryVariables.rrmasterworkspacevariables_lakhouseid",
                                        "rootFolder": "Tables"
                                    },
                                    "externalReferences": {
                                        "connection": "@pipeline().libraryVariables.rrmasterworkspacevariables_lakehouse_Conn_ID"
                                    }
                                }
                            },
                            "type": "LakehouseTable",
                            "schema": [],
                            "typeProperties": {
                                "table": "b262008_emp_data_from_sqldb"
                            }
                        }
                    },
                    "enableStaging": false,
                    "translator": {
                        "type": "TabularTranslator",
                        "typeConversion": true,
                        "typeConversionSettings": {
                            "allowDataTruncation": true,
                            "treatBooleanAsNumber": false
                        }
                    }
                }
            }
        ],
        "libraryVariables": {
            "rrmasterworkspacevariables_Workspaceid": {
                "type": "String",
                "variableName": "Workspaceid",
                "libraryName": "rr-master-workspace-variables"
            },
            "rrmasterworkspacevariables_sqldatabases": {
                "type": "String",
                "variableName": "sqldatabases",
                "libraryName": "rr-master-workspace-variables"
            },
            "rrmasterworkspacevariables_SqlDB_conn_id": {
                "type": "String",
                "variableName": "SqlDB_conn_id",
                "libraryName": "rr-master-workspace-variables"
            },
            "rrmasterworkspacevariables_lakhouseid": {
                "type": "String",
                "variableName": "lakhouseid",
                "libraryName": "rr-master-workspace-variables"
            },
            "rrmasterworkspacevariables_lakehouse_Conn_ID": {
                "type": "String",
                "variableName": "lakehouse_Conn_ID",
                "libraryName": "rr-master-workspace-variables"
            }
        },
        "lastModifiedByObjectId": "07dffa9c-d10a-43aa-a4dc-89568542f3c3",
        "lastPublishTime": "2026-02-09T02:00:14Z"
    }
}
```


