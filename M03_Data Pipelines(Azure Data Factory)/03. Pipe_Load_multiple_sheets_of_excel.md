# üöÄ Microsoft Fabric Data Pipeline: Load Multiple Excel Sheets to Lakehouse

This document explains how to create a Data Pipeline in **Microsoft Fabric** that loads data from **multiple Excel sheets** into a Lakehouse table using a `ForEach` activity and a `Copy` activity.

![image](https://github.com/user-attachments/assets/327dd826-f9a0-4958-990f-019ebee2acda)


---

## üß≠ Navigation Steps in Microsoft Fabric

Follow these steps to implement this pipeline in Microsoft Fabric:

1. **Go to the Microsoft Fabric workspace** where your Lakehouse is located.
2. Upload file into Lakehouse rawdata folder Load_multiple_sheets_of_excel.xlsx
3. Click **+ New Item** > **Data Pipeline** to create a new pipeline.
4. **Rename the pipeline** to `Load_Multiple_Excel_Sheets_To_Lakehouse`.
5. Define a pipeline **parameter** named `pSheets`:
    ```json
    ["CA", "Texas", "Seattle"]
    ```

6. From the **Activities** pane, drag the `ForEach` activity onto the canvas.
7. Click on the `ForEach` activity and configure it:
   - Set **Items** to `@pipeline().parameters.pSheets`
   - Enable **IsSequential**
8. Inside the `ForEach`, add a `Copy data` activity.
9. Configure the **Source**:
   - **Source Type:** Excel
   - **Linked Service:** Your Lakehouse (e.g., `rr_batch100`)
   - **File Name:** `Load_multiple_sheets_of_excel.xlsx`
   - **Folder Path:** `rawdata`
   - **Sheet Name:** `@item()` (from the loop)
   - **First Row as Header:** True
10. Configure the **Sink**:
   - **Sink Type:** Lakehouse Table
   - **Table Name:** `test202504111`
   - **Write Behavior:** Append
   - **Lakehouse Path:** `Tables`
   - **Linked Service:** `rr_batch100`
11. Set the **Translator** to `TabularTranslator` and enable:
    - Type conversion
    - Allow data truncation

12. Click **Publish** to save the pipeline.

---

## üìå Pipeline Overview

- **Pipeline Name:** `Load_Multiple_Excel_Sheets_To_Lakehouse`
- **Purpose:** Load data from each Excel sheet in a list and append into one Lakehouse table.
- **Parameter Used:** `pSheets` (array of sheet names)

---

## üß© Parameter Details

| Parameter | Type  | Default Value                 |
|-----------|-------|-------------------------------|
| pSheets   | Array | `["CA", "Texas", "Seattle"]`  |

---

## üîÅ ForEach Activity

### Name: `ForEach1`
- **Execution Mode:** Sequential
- **Iterates Over:** `@pipeline().parameters.pSheets`

---

## üì• Copy Activity

### Name: `Copy data1`

#### üîπ Source Settings
- **Source Type:** Excel
- **Lakehouse Path:** `rawdata/Load_multiple_sheets_of_excel.xlsx`
- **Lakehouse Linked Service:** `rr_batch100`
- **Sheet Name:** `@item()` (from ForEach loop)
- **Read Options:**
  - Recursive: True
  - First Row as Header: True

#### üî∏ Sink Settings
- **Sink Type:** Lakehouse Table
- **Target Table:** `test202504111`
- **Mode:** Append
- **Lakehouse Path:** `Tables`
- **Linked Service:** `rr_batch100`


---

## ‚úÖ Summary

This pipeline automates reading from multiple sheets within a single Excel file and appends them into one unified Lakehouse table using Microsoft Fabric's Data Factory.

---

## üóÇÔ∏è Full JSON Code (Optional)

<details>
<summary>Click to expand the JSON</summary>

```json
{
    "name": "pipeline39_parameter_foreach",
    "objectId": "4afd6581-c22b-4098-88d2-97b3298f3671",
    "properties": {
        "activities": [
            {
                "name": "Copy data1",
                "type": "Copy",
                "dependsOn": [],
                "policy": {
                    "timeout": "0.12:00:00",
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "typeProperties": {
                    "source": {
                        "type": "BinarySource",
                        "storeSettings": {
                            "type": "HttpReadSettings",
                            "requestMethod": "GET"
                        },
                        "formatSettings": {
                            "type": "BinaryReadSettings"
                        },
                        "datasetSettings": {
                            "annotations": [],
                            "type": "Binary",
                            "typeProperties": {
                                "location": {
                                    "type": "HttpServerLocation"
                                }
                            },
                            "externalReferences": {
                                "connection": "59eb3c17-281f-46ad-842f-1f985923588c"
                            }
                        }
                    },
                    "sink": {
                        "type": "BinarySink",
                        "storeSettings": {
                            "type": "LakehouseWriteSettings"
                        },
                        "datasetSettings": {
                            "annotations": [],
                            "connectionSettings": {
                                "name": "b2026_lakehouse",
                                "properties": {
                                    "annotations": [],
                                    "type": "Lakehouse",
                                    "typeProperties": {
                                        "workspaceId": "55732739-60eb-445b-94c4-65725b7190fa",
                                        "artifactId": "a375dc6e-2dd7-4a0c-a829-7e6bc66cb0a3",
                                        "rootFolder": "Files"
                                    },
                                    "externalReferences": {
                                        "connection": "f0fb8c6b-1fe2-4f0c-803b-425bb27465b7"
                                    }
                                }
                            },
                            "type": "Binary",
                            "typeProperties": {
                                "location": {
                                    "type": "LakehouseLocation",
                                    "fileName": "Load_multiple_sheets_of_excel.xlsx",
                                    "folderPath": "bronze"
                                }
                            }
                        }
                    },
                    "enableStaging": false
                }
            },
            {
                "name": "ForEach1_loop_parameters",
                "type": "ForEach",
                "dependsOn": [
                    {
                        "activity": "Copy data1",
                        "dependencyConditions": [
                            "Succeeded"
                        ]
                    }
                ],
                "typeProperties": {
                    "items": {
                        "value": "@pipeline().parameters.pSheets",
                        "type": "Expression"
                    },
                    "isSequential": true,
                    "activities": [
                        {
                            "name": "Set variable1",
                            "type": "SetVariable",
                            "dependsOn": [],
                            "policy": {
                                "secureOutput": false,
                                "secureInput": false
                            },
                            "typeProperties": {
                                "variableName": "test",
                                "value": {
                                    "value": "@item()",
                                    "type": "Expression"
                                }
                            }
                        },
                        {
                            "name": "Copy data2",
                            "type": "Copy",
                            "dependsOn": [
                                {
                                    "activity": "Set variable1",
                                    "dependencyConditions": [
                                        "Succeeded"
                                    ]
                                }
                            ],
                            "policy": {
                                "timeout": "0.12:00:00",
                                "retry": 0,
                                "retryIntervalInSeconds": 30,
                                "secureOutput": false,
                                "secureInput": false
                            },
                            "typeProperties": {
                                "source": {
                                    "type": "ExcelSource",
                                    "storeSettings": {
                                        "type": "LakehouseReadSettings",
                                        "recursive": true,
                                        "enablePartitionDiscovery": false
                                    },
                                    "datasetSettings": {
                                        "annotations": [],
                                        "connectionSettings": {
                                            "name": "b2026_lakehouse",
                                            "properties": {
                                                "annotations": [],
                                                "type": "Lakehouse",
                                                "typeProperties": {
                                                    "workspaceId": "55732739-60eb-445b-94c4-65725b7190fa",
                                                    "artifactId": "a375dc6e-2dd7-4a0c-a829-7e6bc66cb0a3",
                                                    "rootFolder": "Files"
                                                },
                                                "externalReferences": {
                                                    "connection": "f0fb8c6b-1fe2-4f0c-803b-425bb27465b7"
                                                }
                                            }
                                        },
                                        "type": "Excel",
                                        "typeProperties": {
                                            "sheetName": {
                                                "value": "@item()",
                                                "type": "Expression"
                                            },
                                            "location": {
                                                "type": "LakehouseLocation",
                                                "fileName": "Load_multiple_sheets_of_excel.xlsx",
                                                "folderPath": "bronze"
                                            },
                                            "firstRowAsHeader": true
                                        },
                                        "schema": []
                                    }
                                },
                                "sink": {
                                    "type": "LakehouseTableSink",
                                    "tableActionOption": "Append",
                                    "partitionOption": "None",
                                    "applyVOrder": true,
                                    "datasetSettings": {
                                        "annotations": [],
                                        "connectionSettings": {
                                            "name": "b2026_lakehouse",
                                            "properties": {
                                                "annotations": [],
                                                "type": "Lakehouse",
                                                "typeProperties": {
                                                    "workspaceId": "55732739-60eb-445b-94c4-65725b7190fa",
                                                    "artifactId": "a375dc6e-2dd7-4a0c-a829-7e6bc66cb0a3",
                                                    "rootFolder": "Tables"
                                                },
                                                "externalReferences": {
                                                    "connection": "f0fb8c6b-1fe2-4f0c-803b-425bb27465b7"
                                                }
                                            }
                                        },
                                        "type": "LakehouseTable",
                                        "schema": [],
                                        "typeProperties": {
                                            "schema": "silver",
                                            "table": "emp_excel"
                                        }
                                    }
                                },
                                "enableStaging": false,
                                "translator": {
                                    "type": "TabularTranslator",
                                    "typeConversion": true,
                                    "typeConversionSettings": {
                                        "allowDataTruncation": true,
                                        "treatBooleanAsNumber": false
                                    }
                                }
                            }
                        }
                    ]
                }
            }
        ],
        "parameters": {
            "pSheets": {
                "type": "array",
                "defaultValue": [
                    "CA",
                    "Texas",
                    "Seattle"
                ]
            }
        },
        "variables": {
            "test": {
                "type": "String"
            }
        },
        "lastModifiedByObjectId": "07dffa9c-d10a-43aa-a4dc-89568542f3c3",
        "lastPublishTime": "2026-02-10T01:51:12Z"
    }
}
